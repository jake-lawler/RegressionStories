[["index.html", "Notes on Regression and Other stories by Gelman, Hill &amp; Vehtari Preface", " Notes on Regression and Other stories by Gelman, Hill &amp; Vehtari Jake Lawler 2022-03-30 Preface Im reading through Regression and Other Stories with two goals in mind: try to improve my conceptual understanding of regression improve my coding of base Stan. I dont plan on using this notebook to make chapter summaries like I have with other textbooks. Instead Im just going to use it to practice writing models in Stan, and will make my chapter notes elsewhere. The idea is that Ill need to improve my Stan skills as the models in the book get more complicated. I may use this notebook for end-of-chapter exercises also, well see. I have had some previous exposure to base Stan in my work-through of Statistical Rethinking, so Im not starting completely from scratch. However, I am looking forward to particularly the early portions of this book where Ill hopefully be familiar with a lot of the material and can just focus on applying it using the Stan language. Alongside the book itself, the other text Im going to be reading a lot of is the Stan User Guide and some of the other Stan documentation. That last link includes the reference manuals, but also some example case studies and tutorials which I imagine will be helpful. "],["overview.html", "Chapter 1 Overview 1.1 Stan Models 1.2 Questions", " Chapter 1 Overview 1.1 Stan Models The first model in the book concerns the relationship between incumbent vote share and income growth in U.S. elections. Heres a plot of the data: data(hibbs) ggplot(data = hibbs, aes(x = growth, y = vote))+ geom_text(aes(label=year))+ xlab(&quot;Average recent growth in personal income (%)&quot;)+ ylab(&quot;Incumbent party&#39;s vote share&quot;) Heres the model in the chapter: m1_1 &lt;- stan_glm(vote ~ growth, data=hibbs) # saveRDS(m1_1,file=&quot;models\\\\m1_1.rds&quot;) And heres a plot of the resulting regression line: ggplot(data = hibbs, aes(x = growth, y = vote))+ geom_point()+ geom_abline(intercept = coef(m1_1)[1], slope = coef(m1_1)[2])+ xlab(&quot;Average recent growth in personal income (%)&quot;)+ ylab(&quot;Incumbent party&#39;s vote share&quot;) The stan_glm function comes from the rstanarm package, but Im trying to learn base Stan so Ill have a go at recreating it. Heres the model code. I also pair down the dataset to only the variables that will be used, which I believe is good practice. code_m1_1 &lt;- &quot;data{ int&lt;lower=0&gt; n; vector[n] vote; vector[n] growth; } parameters{ real a; real b; real&lt;lower=0&gt; sigma; } model{ vote ~ normal( a + b * growth , sigma ); }&quot; data_hibbs &lt;- hibbs %&gt;% select(vote,growth) The code has three blocks. In the data block we use \\(n\\) as a stand in for the number of observations in our data. We then specify that variables vote and growth are vectors of length \\(n\\). Our parameters are to be estimated - we have an intercept, a slope, and a noise parameter. The model block defines our model. In this case its just about the simplest possible regression model, with improper priors. Now we run the model: m1_1b &lt;- stan_model(model_name = &quot;m1_1b&quot;,model_code=code_m1_1)%&gt;% sampling(data = compose_data(data_hibbs), chains=1) #saveRDS(m1_1b,file=&quot;models\\\\m1_1b.rds&quot;) The first function here, stan_model, compiles the model and the second samples from it. The result is a stanfit object. Lets recreate the plot above using point estimates for parameters \\(a\\) and \\(b\\): draws1_1b &lt;- m1_1b %&gt;% gather_draws(a, b) %&gt;% mean_qi() ggplot(data = hibbs, aes(x = growth, y = vote))+ geom_point()+ geom_abline(intercept = draws1_1b$.value[1], slope = draws1_1b$.value[2])+ xlab(&quot;Average recent growth in personal income (%)&quot;)+ ylab(&quot;Incumbent party&#39;s vote share&quot;) This looks to be about the same line. Any differences might come from slightly different approaches to default priors in the two packages. The code above used a vectorised form of model specification: vote ~ normal( a + b * growth , sigma ); but its also possible to specify the unvectorised version of the same model: for (i in 1:n) { vote[i] ~ normal(a + b * growth[i], sigma); } According to the user manual, the vectorised form is faster. This section of the user manual also describes writing a regression model with more than one predictor using matrix notation. Heres the example model they use: data { int&lt;lower=0&gt; N; // number of data items int&lt;lower=0&gt; K; // number of predictors matrix[N, K] x; // predictor matrix vector[N] y; // outcome vector } parameters { real alpha; // intercept vector[K] beta; // coefficients for predictors real&lt;lower=0&gt; sigma; // error scale } model { y ~ normal(x * beta + alpha, sigma); // likelihood } The matrix of predictors \\(x\\) multiplies the vector of coefficients \\(\\beta\\). Consider trying this once you get to multiple regression in the book. Thats more or less the only model in the first chapter of Regression and Other Stories. so Ill leave my notes there. 1.2 Questions Ive not done any of the end-of-chapter exercises for this one. "],["data_measurement.html", "Chapter 2 Data and Measurement", " Chapter 2 Data and Measurement Chapters 2-5 dont include models. Since Im using this notebook to recreate models in base Stan, I havent made notes on those chapters. Ill pick things up again for chapter 6. "],["basic_methods.html", "Chapter 3 Some Basic Methods in Mathematics and Probability", " Chapter 3 Some Basic Methods in Mathematics and Probability Chapters 2-5 dont include models. Since Im using this notebook to recreate models in base Stan, I havent made notes on those chapters. Ill pick things up again for chapter 6. "],["statistical_inference.html", "Chapter 4 Statistical Inference", " Chapter 4 Statistical Inference Chapters 2-5 dont include models. Since Im using this notebook to recreate models in base Stan, I havent made notes on those chapters. Ill pick things up again for chapter 6. "],["simulation.html", "Chapter 5 Simulation", " Chapter 5 Simulation Chapters 2-5 dont include models. Since Im using this notebook to recreate models in base Stan, I havent made notes on those chapters. Ill pick things up again for chapter 6. "],["regression_background.html", "Chapter 6 Background on Regression Modelling 6.1 Stan Models 6.2 Questions Further Reading", " Chapter 6 Background on Regression Modelling 6.1 Stan Models 6.2 Questions Further Reading "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
